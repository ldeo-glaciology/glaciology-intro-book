
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Discrete fourier transforms and phase &#8212; The Glaciology Data Analysis and Modeling book</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Phase and Frequency" href="phase-frequency.html" />
    <link rel="prev" title="Beat frequency" href="beat-frequency.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/thumbnail.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">The Glaciology Data Analysis and Modeling book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../book-intro.html">
   The Glaciology Data Analysis and Modeling book
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Ice flow
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../ice_flow/ice-flow-intro.html">
   Introduction to ice flow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ice_flow/ablation_accumulation.html">
   Ice flow, accumulation and ablation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ice_flow/antarctic-ice-flow.html">
   Flow of the Antarctic Ice sheet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ice_flow/vec_calc.html">
   Vector calculus background
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ice_flow/strain_velocity.html">
   Strain rate and velocity fields
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ice_flow/gradient.html">
   The gradient of Antarctic Ice Sheet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ice_flow/rheology.html">
   Ice rheology (under construction)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ice_flow/stress_strain_tensors.html">
   Stress and strain tensors (under construction)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ice_flow/deviatoric_stress.html">
   Deviatoric stress
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ice_flow/driving_stress.html">
   Driving stress (under construction)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ice_flow/depth_integrated_mass_balance.html">
   depth-integrated mass balance (under construction)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ice_flow/stress_balance_eqns.html">
   Stress balance equations
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Radar
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../impulse/impulse-radar.html">
   Impulse Radar
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="apres-intro.html">
   Autonomous phase-sensitive radio echo sounder
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="apres-range-frequency.html">
     Frequency and range
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="beat-frequency.html">
     Beat frequency
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Discrete fourier transforms and phase
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="phase-frequency.html">
     Phase and Frequency
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="stacking.html">
     Stacking ApRES data
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Heat flow
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../temperature/heat_intro.html">
   Heat flow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../temperature/heat_equation.html">
   Heat equation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../temperature/analytical_solution.html">
   An analytical solution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../temperature/numerical_solutions.html">
   Numerical solutions
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../appendix/upload_Measures_data_to_bucket.html">
   Adding the MEASURES data to the google bucket
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../bibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/sections/radar/apres/coarse-range.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/jkingslake/apres_jp"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/jkingslake/apres_jp/issues/new?title=Issue%20on%20page%20%2Fsections/radar/apres/coarse-range.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/jkingslake/apres_jp/edit/main/src/sections/radar/apres/coarse-range.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/jkingslake/apres_jp/main?urlpath=lab/tree/src/sections/radar/apres/coarse-range.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#define-some-reflectors">
   1. Define some reflectors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#compute-the-two-way-travel-time-to-the-reflectors">
   2. Compute the two-way travel time to the reflectors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#compute-the-beat-frequencies-we-would-receive-from-these-reflectors">
   3. Compute the beat frequencies we would receive from these reflectors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#construct-our-signal">
   4. Construct our signal
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#compute-frequencies-with-a-fourier-transform">
   5. Compute frequencies with a fourier transform
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#convert-frequency-to-range">
   6. Convert frequency to range
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#below-this-is-scrap">
   below this is scrap
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Discrete fourier transforms and phase</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#define-some-reflectors">
   1. Define some reflectors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#compute-the-two-way-travel-time-to-the-reflectors">
   2. Compute the two-way travel time to the reflectors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#compute-the-beat-frequencies-we-would-receive-from-these-reflectors">
   3. Compute the beat frequencies we would receive from these reflectors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#construct-our-signal">
   4. Construct our signal
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#compute-frequencies-with-a-fourier-transform">
   5. Compute frequencies with a fourier transform
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#convert-frequency-to-range">
   6. Convert frequency to range
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#below-this-is-scrap">
   below this is scrap
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="discrete-fourier-transforms-and-phase">
<h1>Discrete fourier transforms and phase<a class="headerlink" href="#discrete-fourier-transforms-and-phase" title="Permalink to this headline">¶</a></h1>
<p>(under construction)</p>
<p>This page demonstrates the use of a fourier transform to compute the range to reflectors in ApRES data.</p>
<p>The idealized sinusoidal signals used in these demonstrations are intended to be simplified version of the signals recorded by ApRES. Specifically, they represent the signal obtained when the received signal is differenced with the transmitted signal. In general this results in a signal with a wide range of different frequencies. However, we will construct our synthetic signal with only two frequencies.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">argrelextrema</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="define-some-reflectors">
<h2>1. Define some reflectors<a class="headerlink" href="#define-some-reflectors" title="Permalink to this headline">¶</a></h2>
<p>Suppose that there are just two reflectors beneath you when you deploy ApRES. In reality there are hundreds, but we will assume there are just two.</p>
<p>Let’s use <span class="math notranslate nohighlight">\(R\)</span> as the range, and define the range to the two reflectors as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span> <span class="o">=</span> <span class="mf">50.0</span>  <span class="c1"># units [m]</span>
<span class="n">R2</span> <span class="o">=</span> <span class="mf">120.0</span>  <span class="c1"># units [m]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="compute-the-two-way-travel-time-to-the-reflectors">
<h2>2. Compute the two-way travel time to the reflectors<a class="headerlink" href="#compute-the-two-way-travel-time-to-the-reflectors" title="Permalink to this headline">¶</a></h2>
<p>The two-way radio-wave travel time in ice <span class="math notranslate nohighlight">\(\tau\)</span> is given by</p>
<div class="math notranslate nohighlight" id="equation-eq-tau1">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-tau1" title="Permalink to this equation">¶</a></span>\[\tau = 2R\frac{\sqrt\epsilon}{c},\]</div>
<p>where <span class="math notranslate nohighlight">\(c\)</span> is the speed of light in a vacuum and <span class="math notranslate nohighlight">\(\epsilon\)</span> is the dielactric constant of ice.</p>
<p>Next, let’s use constants from <span id="id1">[<a class="reference internal" href="../../../bibliography.html#id2" title="Paul V. Brennan, Lai Bun Lok, Keith Nicholls, and Hugh Corr. Phase-sensitive FMCW radar system for high-precision Antarctic ice shelf profile monitoring. IET Radar, Sonar &amp; Navigation, 8(7):776–786, 2014. _eprint: https://onlinelibrary.wiley.com/doi/pdf/10.1049/iet-rsn.2013.0053. URL: https://onlinelibrary.wiley.com/doi/abs/10.1049/iet-rsn.2013.0053 (visited on 2022-01-14), doi:10.1049/iet-rsn.2013.0053.">Brennan <em>et al.</em>, 2014</a>]</span>, to compute <span class="math notranslate nohighlight">\(\tau\)</span> for our two reflectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ep</span> <span class="o">=</span> <span class="mf">3.1</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">299792458</span>
<span class="n">tau1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">R1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ep</span><span class="p">)</span><span class="o">/</span><span class="n">c</span>
<span class="n">tau2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">R2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ep</span><span class="p">)</span><span class="o">/</span><span class="n">c</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;tau1 is </span><span class="si">{</span><span class="n">tau1</span><span class="si">:</span><span class="s1">.3e</span><span class="si">}</span><span class="s1"> s.&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;tau2 is </span><span class="si">{</span><span class="n">tau2</span><span class="si">:</span><span class="s1">.3e</span><span class="si">}</span><span class="s1"> s.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tau1 is 5.873e-07 s.
tau2 is 1.410e-06 s.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="compute-the-beat-frequencies-we-would-receive-from-these-reflectors">
<h2>3. Compute the beat frequencies we would receive from these reflectors<a class="headerlink" href="#compute-the-beat-frequencies-we-would-receive-from-these-reflectors" title="Permalink to this headline">¶</a></h2>
<p>Equation 1 from Brennan et al. relates the difference in frequency between the transmitted and received signals (the beat frequency; <span class="math notranslate nohighlight">\(f_d\)</span>) to <span class="math notranslate nohighlight">\(\tau\)</span> using some configuration parameters related to how the frequency changes during each chirp:</p>
<div class="math notranslate nohighlight" id="equation-eq-f-d1">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq-f-d1" title="Permalink to this equation">¶</a></span>\[f_d = K\tau = \frac{2\pi B \tau}{T}, \]</div>
<p>where <span class="math notranslate nohighlight">\(K\)</span> is the rate of frequency increase in Hz s<span class="math notranslate nohighlight">\(^{-1}\)</span>, <span class="math notranslate nohighlight">\(B\)</span> is the bandwidth (the difference between the lowest and highest frequency covered by each chirp), and <span class="math notranslate nohighlight">\(T\)</span> is the chirp duration.</p>
<p>Again using parameters from Brennan et al., let’s compute the beat frequencies we expect to receive from our two reflectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="mf">200e6</span>           <span class="c1"># [Hz]</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">1</span>               <span class="c1"># [s]</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">B</span><span class="o">/</span><span class="n">T</span>             <span class="c1"># [Hz/s^2]</span>

<span class="n">f1</span> <span class="o">=</span> <span class="n">K</span><span class="o">*</span><span class="n">tau1</span>     <span class="c1"># [Hz]</span>
<span class="n">f2</span> <span class="o">=</span> <span class="n">K</span><span class="o">*</span><span class="n">tau2</span>     <span class="c1"># [Hz]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;f1 = </span><span class="si">{</span><span class="n">f1</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Hz.&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;f2 = </span><span class="si">{</span><span class="n">f2</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Hz.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>f1 = 117.46 Hz.
f2 = 281.90 Hz.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="construct-our-signal">
<h2>4. Construct our signal<a class="headerlink" href="#construct-our-signal" title="Permalink to this headline">¶</a></h2>
<p>The signal ApRES recieves is the sum of two sinusoids. One has a frequency of <code class="docutils literal notranslate"><span class="pre">f1</span></code> and the other <code class="docutils literal notranslate"><span class="pre">f2</span></code>.</p>
<p>Before computing the received signal, we need to define a sampling frequncy, which is controlled by the ApRES system (Brennan used 12 kHz),</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sampling_frequency</span> <span class="o">=</span> <span class="mf">12e3</span>    <span class="c1"># [Hz]</span>
</pre></div>
</div>
</div>
</div>
<p>and define a sampling vector,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samplingInterval</span>       <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">sampling_frequency</span><span class="p">;</span>   <span class="c1"># [s]</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">samplingInterval</span><span class="p">)</span>                <span class="c1"># [s]</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can define the signal ApRES receives</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f1</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>  <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f2</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>     
</pre></div>
</div>
</div>
</div>
<p>Plot the signal to convince ourselves that this is an oscillatory signal.</p>
<p>The code below plots a small section of the real and imaginary parts of <code class="docutils literal notranslate"><span class="pre">s</span></code> on the left and both components against each other in the complex plane (on an Argand diagram) on the right.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="c1"># the real and imaginary components of the signal in the plot on the left</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">s</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;received signal time series&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t [s]&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">s</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;imaginary&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># The Argand diagram on the right</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">s</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;received signal complex plane&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Im(s)&#39;</span><span class="p">);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Re(s)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/coarse-range_17_0.png" src="../../../_images/coarse-range_17_0.png" />
</div>
</div>
</div>
<div class="section" id="compute-frequencies-with-a-fourier-transform">
<h2>5. Compute frequencies with a fourier transform<a class="headerlink" href="#compute-frequencies-with-a-fourier-transform" title="Permalink to this headline">¶</a></h2>
<p>The signal recieved by ApRES is a combination of signals from every reflector. The frequencies of these signals is directly proportional
to the range to the reflectors. The frequencies that make up a signal can be extracted using a fourier transform. <a class="reference external" href="https://www.youtube.com/watch?v=spUNpyF58B">This video</a> is an incredibly clear explanation of how fourier transforms achieve this.</p>
<p>The cell below computes the discrete fourier transform of <code class="docutils literal notranslate"><span class="pre">s</span></code> and the frequency bins. By default <code class="docutils literal notranslate"><span class="pre">np.fft.fft</span></code> produces as many freqency bins as there are time-domain samples (<code class="docutils literal notranslate"><span class="pre">=len(s)</span></code>), evenly distributed between 0 Hz and the sampling frequency (12x10<span class="math notranslate nohighlight">\(^3\)</span>). Therefore the value of the frequencies is computed by multiplying the indexes by <code class="docutils literal notranslate"><span class="pre">sampling_frequency/no_of_samples</span></code>, which is equal to <span class="math notranslate nohighlight">\(1/T = 1\)</span>s. Note also that the frequency spectrum is normalized by the number of samples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">no_of_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="n">no_of_samples</span>         
<span class="n">indexes</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">no_of_samples</span><span class="p">)</span> 
<span class="n">frequencies</span>  <span class="o">=</span> <span class="n">indexes</span> <span class="o">*</span> <span class="n">sampling_frequency</span><span class="o">/</span><span class="n">no_of_samples</span>
</pre></div>
</div>
</div>
</div>
<p>Next we compute the absolute value of the complex numbers in <code class="docutils literal notranslate"><span class="pre">S</span></code> and plot them against the frequencies yielding the usual depiction of frequency domain.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;frequency domain&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency [Hz]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">800</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/coarse-range_22_0.png" src="../../../_images/coarse-range_22_0.png" />
</div>
</div>
<p>The plot displays two peaks in spectral energy at</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">peaks</span> <span class="o">=</span> <span class="n">argrelextrema</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">greater</span><span class="p">)</span>      <span class="c1"># this function finds local maxima  </span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; first peak detected at </span><span class="si">{</span><span class="n">frequencies</span><span class="p">[</span><span class="n">peaks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> Hz.&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;second peak detected at </span><span class="si">{</span><span class="n">frequencies</span><span class="p">[</span><span class="n">peaks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> Hz.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> first peak detected at 117.000 Hz.
second peak detected at 282.000 Hz.
</pre></div>
</div>
</div>
</div>
<p>Notice how the frequencies are close to the frequencies we computed above (<code class="docutils literal notranslate"><span class="pre">f1</span></code> and <code class="docutils literal notranslate"><span class="pre">f2</span></code>) but because <code class="docutils literal notranslate"><span class="pre">frequencies</span></code> is quantized and (in our case) increases in 1 Hz increments, the retrieved spectral peaks are restricted to be an integer number of Hz. This is why Brennan et al. call this the coarse range measurment.</p>
</div>
<div class="section" id="convert-frequency-to-range">
<h2>6. Convert frequency to range<a class="headerlink" href="#convert-frequency-to-range" title="Permalink to this headline">¶</a></h2>
<p>Next we convert <code class="docutils literal notranslate"><span class="pre">frequencies</span></code> to depths using a combination of <a class="reference internal" href="#equation-eq-tau1">(1)</a> and <a class="reference internal" href="#equation-eq-f-d1">(2)</a>,</p>
<p><span class="math notranslate nohighlight">\(
f_d = 2KR\frac{\sqrt\epsilon}{c},
\)</span></p>
<p>Rearranging this expression for <span class="math notranslate nohighlight">\(R\)</span> gives</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">range</span> <span class="o">=</span> <span class="n">frequencies</span> <span class="o">*</span> <span class="n">c</span> <span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">K</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ep</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>which allows us to produce the amplitude-range plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;amplitude-range plot showing our two reflectors&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;range [m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">R2</span><span class="o">*</span><span class="mf">1.2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/coarse-range_30_0.png" src="../../../_images/coarse-range_30_0.png" />
</div>
</div>
<p>…and compute the range of the reflectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; first reflector detected at </span><span class="si">{</span><span class="nb">range</span><span class="p">[</span><span class="n">peaks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> m.&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;second reflector detected at </span><span class="si">{</span><span class="nb">range</span><span class="p">[</span><span class="n">peaks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> m.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> first reflector detected at 49.804 m.
second reflector detected at 120.041 m.
</pre></div>
</div>
</div>
</div>
<p>The retrieved ranges to the two reflectors are close to the prescribed values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">R1</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">R2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>50.0
120.0
</pre></div>
</div>
</div>
</div>
<p>but, again, they are a coarse measurement due to the resolution of the frequency spectrum, which in turn derives from the bandwidth, <span class="math notranslate nohighlight">\(B\)</span> and the rate of increase in frequencies <span class="math notranslate nohighlight">\(K\)</span>.</p>
</div>
<div class="section" id="below-this-is-scrap">
<h2>below this is scrap<a class="headerlink" href="#below-this-is-scrap" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; first reflector detected at </span><span class="si">{</span><span class="n">phase</span><span class="p">[</span><span class="n">peaks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> rad.&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;second reflector detected at </span><span class="si">{</span><span class="n">phase</span><span class="p">[</span><span class="n">peaks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> rad.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> first reflector detected at 1.446 rad.
second reflector detected at -0.303 rad.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;amplitude-range plot showing our two reflectors&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;range [m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;phase&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">R2</span><span class="o">*</span><span class="mf">1.2</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/coarse-range_38_0.png" src="../../../_images/coarse-range_38_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_c</span> <span class="o">=</span> <span class="mf">300e6</span>       <span class="c1"># [Hz]</span>
<span class="n">lam</span> <span class="o">=</span> <span class="n">c</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ep</span><span class="p">)</span> <span class="o">/</span> <span class="n">f_c</span>
<span class="n">Rfine1</span> <span class="o">=</span> <span class="n">lam</span> <span class="o">*</span> <span class="n">phase</span><span class="p">[</span><span class="n">peaks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">Rfine2</span> <span class="o">=</span> <span class="n">lam</span> <span class="o">*</span> <span class="n">phase</span><span class="p">[</span><span class="n">peaks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Rfine1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Rfine2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.06530727388987519
-0.013693240278268263
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this does not recreate the phase analysis here: https://www.gaussianwaves.com/2015/11/interpreting-fft-results-obtaining-magnitude-and-phase-information/</span>


<span class="c1">#X2=X;%store the FFT results in another array</span>
<span class="c1">#%detect noise (very small numbers (eps)) and ignore them</span>
<span class="c1">#threshold = max(abs(X))/10000; %tolerance threshold</span>
<span class="c1">#X2(abs(X)&lt;threshold) = 0; %maskout values that are below the threshold</span>
<span class="c1">#phase=atan2(imag(X2),real(X2))*180/pi; %phase information</span>
<span class="c1">#plot(f,phase); %phase vs frequencies</span>
<span class="n">phi_shift</span> <span class="o">=</span> <span class="mi">30</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f1</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">phi_shift</span><span class="p">)</span>

<span class="n">no_of_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="n">no_of_samples</span>         
<span class="n">indexes</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">no_of_samples</span><span class="p">)</span> 
<span class="n">frequencies</span>  <span class="o">=</span> <span class="n">indexes</span> <span class="o">*</span> <span class="n">sampling_frequency</span><span class="o">/</span><span class="n">no_of_samples</span>

<span class="nb">range</span> <span class="o">=</span> <span class="n">frequencies</span> <span class="o">*</span> <span class="n">c</span> <span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">K</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ep</span><span class="p">))</span>

<span class="n">S2</span> <span class="o">=</span> <span class="n">S</span>
<span class="n">threshold</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="mi">1000</span>
<span class="n">S2</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">&lt;</span><span class="n">threshold</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">S2</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span><span class="n">S2</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>


<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;amplitude-range plot showing our two reflectors&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;range [m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">R2</span><span class="o">*</span><span class="mf">1.2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/coarse-range_40_0.png" src="../../../_images/coarse-range_40_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "jkingslake/apres_jp",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./sections/radar/apres"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="beat-frequency.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Beat frequency</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="phase-frequency.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Phase and Frequency</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By The Jupyter Book community<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>